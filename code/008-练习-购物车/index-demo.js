angular.module('myApp',[])    .controller('cartController',['$http','$scope',function ($http, $scope) {            $http.get("cart.json").success(function (data) {                $scope.cart = data.cart;            });            //建立一个产品ID的索引，判断是否ID相等            function findIndex(id) {                var index = -1;                angular.forEach($scope.cart, function (item, key) {                    if (item.id === id) {                        index = key;                        return;                    }                });                return index            }            //计算总价            $scope.totalPrice = function () {                var total = 0;                angular.forEach($scope.cart, function (item) {                    total += item.quantity * item.price                });                return total;            };            //计算总数            $scope.totalQuantity = function () {                var total = 0;                angular.forEach($scope.cart, function (item) {                    total += parseInt(item.quantity)                });                return total;            };            //移除某一项,这将作为一个方法之后被多次调用。            $scope.remove = function (id) {                var index = findIndex(id);                //从第几个开始，删除一位                if (index !== -1) {                    $scope.cart.splice(index, 1)                }            };            //清空            $scope.allRemove = function () {                $scope.cart = []            };            //增加购物数量            $scope.add = function (id) {                var index = findIndex(id);                if (index !== -1) {                    ++$scope.cart[index].quantity;                }            };            //减少购物数量            $scope.reduce = function (id) {                var index = findIndex(id);                if (index !== -1) {                    var item = $scope.cart[index];                    if (item.quantity >= 1) {                        --item.quantity;                    }else{                        var returnkey = confirm('从购物车删除该产品');                        if(returnkey){                            $scope.remove(id);                        }                    }                }            };            //负数删除            $scope.$watch('cart',function (newValue, oldValue) {                angular.forEach(newValue,function (item,key) {                    if(item.quantity<0){                        var returnkey = confirm('从购物车删除该产品');                        if(returnkey){                            $scope.remove(item.id);                        }else{                            item.quantity=oldValue[key].quantity;                        }                        return;                    }                })            },true)        }]    );